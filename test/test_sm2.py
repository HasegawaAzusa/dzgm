from dzgm import sm2

# encrypt() and decrypt()
e = sm2.SM2(p = 0x8542D69E4C044F18E8B92435BF6FF7DE457283915C45517D722EDB8B08F1DFC3, a = 0x787968B4FA32C3FD2417842E73BBFEFF2F3C848B6831D7E0EC65228B3937E498, b = 0x63E4C6D3B23B0C849CF84241484BFE48F61D59A5B16BA06E6E12D1DA27C5249A, G = (0x421DEBD61B62EAB6746434EBC3CC315E32220B3BADD50BDC4C4E6C147FEDD43D, 0x0680512BCBB42C07D47349D2153B70C4E5D7FDFCBFA36EA1A85841B9E46E09A2), n = 0x8542D69E4C044F18E8B92435BF6FF7DD297720630485628D5AE74EE7C32E79B7, private_key = 0x1649AB77A00637BD5E2EFE283FBF353534AA7F7CB89463F208DDBC2920BB0DA0)
M = b'encryption standard'
C = e.encrypt(M = M, k0 = 0x4C62EEFD6ECFC2B95B92FD6C3D9575148AFA17425546D49018E5388D49DD7B4F)
M_ = e.decrypt(C)
assert M == M_

# sign() and verify()
M = b'message digest'
e = sm2.SM2(p = 0x8542D69E4C044F18E8B92435BF6FF7DE457283915C45517D722EDB8B08F1DFC3, a = 0x787968B4FA32C3FD2417842E73BBFEFF2F3C848B6831D7E0EC65228B3937E498, b = 0x63E4C6D3B23B0C849CF84241484BFE48F61D59A5B16BA06E6E12D1DA27C5249A, G = (0x421DEBD61B62EAB6746434EBC3CC315E32220B3BADD50BDC4C4E6C147FEDD43D, 0x0680512BCBB42C07D47349D2153B70C4E5D7FDFCBFA36EA1A85841B9E46E09A2), n = 0x8542D69E4C044F18E8B92435BF6FF7DD297720630485628D5AE74EE7C32E79B7, private_key = 0x128B2FA8BD433C6C068C8D803DFF79792A519A55171B1B650C23661D15897263)
Z = bytes.fromhex('F4A38489E32B45B6F876E3AC2168CA392362DC8F23459C1D1146FC3DBFB7BC9A')
H = sm2.sm3.hash(Z + M)
r, s = e.sign(H, k0 = 0x6CB28D99385C175C94F94E934817663FC176D925DD72B727260DBAAE1FB2F96F)
assert 0x6D3FBA26EAB2A1054F5D198332E335817C8AC453ED26D3391CD4439D825BF25B == r
assert 0x3124C5688D95F0A10252A9BED033BEC84439DA384621B6D6FAD77F94B74A9556 == s
assert e.verify(H, r, s)

# raw_sign() and raw_verify()
ID = b'ALICE123@YAHOO.COM'
r, s = e.raw_sign(M, ID, k0 = 0x6CB28D99385C175C94F94E934817663FC176D925DD72B727260DBAAE1FB2F96F)
assert 0x6D3FBA26EAB2A1054F5D198332E335817C8AC453ED26D3391CD4439D825BF25B == r
assert 0x3124C5688D95F0A10252A9BED033BEC84439DA384621B6D6FAD77F94B74A9556 == s
assert e.raw_verify(M, ID, r, s)
